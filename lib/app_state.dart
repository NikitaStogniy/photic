import 'package:flutter/material.dart';
import 'flutter_flow/request_manager.dart';
import '/backend/backend.dart';
import '/backend/schema/structs/index.dart';
import 'backend/api_requests/api_manager.dart';
import 'package:shared_preferences/shared_preferences.dart';
import 'flutter_flow/flutter_flow_util.dart';

class FFAppState extends ChangeNotifier {
  static FFAppState _instance = FFAppState._internal();

  factory FFAppState() {
    return _instance;
  }

  FFAppState._internal();

  static void reset() {
    _instance = FFAppState._internal();
  }

  Future initializePersistedState() async {
    prefs = await SharedPreferences.getInstance();
    _safeInit(() {
      _maskImg = prefs.getString('ff_maskImg') ?? _maskImg;
    });
    _safeInit(() {
      _TermsOfUse = prefs.getString('ff_TermsOfUse') ?? _TermsOfUse;
    });
    _safeInit(() {
      _PrivacyPolicy = prefs.getString('ff_PrivacyPolicy') ?? _PrivacyPolicy;
    });
  }

  void update(VoidCallback callback) {
    callback();
    notifyListeners();
  }

  late SharedPreferences prefs;

  String _maskImg = '';
  String get maskImg => _maskImg;
  set maskImg(String _value) {
    _maskImg = _value;
    prefs.setString('ff_maskImg', _value);
  }

  String _TermsOfUse =
      'Effective date: July 8, 2022Welcome to LEP trading S.R.O. (“Company”, “we”, “us” or “our”), a mobile technology company specializing in deep learning-related products. Our goal is to move forward mobile photography creation to the next level using neural networks, deep learning and computer vision technics. We aim to create new ways for people to express their emotions through the camera.These Terms of Use (these “Terms”) apply to all users and others who download, install, register with, access or use (“Use” and “Users”, “you”, as applicable) our mobile application Photiq Photo Editor (“Photiq” or “application”).These Terms are a binding contract between you and us. By accepting these Terms through Using Photiq, you are accepting and agreeing to these Terms on behalf of yourself or the entity that you represent in connection with the Use of Photiq. If you are Using Photiq on behalf of another person or entity, you represent that you are authorized to accept these Terms on that person’ or entity’s behalf and that such person or entity agrees to be responsible to us if you or the other person or entity violates these Terms.By Using Photiq, you agree to these Terms. If you do not agree to these Terms, including the mandatory arbitration provision and class action waiver in Section 15 (Dispute Resolution; Binding Arbitration), do not Use Photiq. Your continued Use of Photiq will confirm your acceptance of these Terms.If you have any questions about these Terms or Photiq, please contact us (for contact information, please, see How to Contact Us Section).1. DESCRIPTION OF PHOTIQPhotiq is an application based software that uses artificial intelligence algorithms to transform your photos into works of art or change the background or foreground, overlay objects with different objects and clone/copy the style or effects from other image. The artificial intelligence algorithms use styles inspired by various famous artists. Photiq allows you to (i) take photos Using the application or (ii) upload preexisting photos onto the application. You can then apply different stylized filters or effects to the photos. Once you choose a filter or effect, Photiq algorithm runs, transforming the photo. You can then share the photos through social media sites or store them for personal use.2. ELIGIBILITYGeneral age limitation. You must be at least 13 years of age to Use Photiq. If you are under 18 years of age (or the age of legal majority where you live), you may only Use Photiq under the supervision of a parent or legal guardian who agrees to be bound by these Terms. If you are a parent or legal guardian of a User under the age of 18 (or the age of legal majority), you agree to be fully responsible for the acts or omissions of such User in connection with Photiq.Age limitation for the European Economic Area (“EEA”) residents. Due to requirements of the General Data Protection Regulation (“GDPR”) you shall be at least 16 years old in order to Use Photiq. To the extent prohibited by applicable law, we do not allow Use of Photiq by the EEA residents younger than 16 years old. If you are aware of anyone younger than 16 Using Photiq, please contact us (for contact information, please, see How to Contact Us Section) and we will take reasonable steps to preclude such person from Using Photiq.You represent and warrant that you have the full power and authority to enter into this agreement and that in doing so you will not violate any other agreement to which you are a party and that you have not been previously suspended or removed from Using Photiq. You further agree to Use Photiq in compliance with all applicable laws. Photiq is not available to any Users previously prohibited from Using it.3. USER ACCOUNTS AND ACCOUNT SECURITYCertain Photiq features or functionalities, that we may establish and maintain from time to time and in our sole discretion, may require you to register an account with us (“Account”). By creating an Account, you agree to: (i) provide accurate, current, and complete information for your Account, (ii) maintain and promptly update, as necessary, your Account information, (iii) maintain the security of your Account login information, (iv) be responsible for the acts or omissions of any third party who has authority to Use Photiq on your behalf, and (v) immediately notify us if you discover or otherwise suspect any security breaches related to your Account. You are entirely responsible for maintaining the confidentiality of your Account login information and for all activities that occur in your Account. We are not liable for any loss or damage arising from your failure to comply with the above requirements.You may register your Account using a valid account on the app store or marketplace from which you downloaded Photiq (e.g. Apple App Store, Google Play, etc.) (each such account, a “Third-Party Account”). By using Third-Party Account to register your Account, you are allowing Photiq to access your Third-Party Account as permitted under the applicable terms and conditions that govern your and/our use of such Third-Party Account. PLEASE NOTE THAT YOUR RELATIONSHIP WITH THE THIRD-PARTY SERVICE PROVIDERS ASSOCIATED WITH YOUR THIRD-PARTY ACCOUNTS IS GOVERNED SOLELY BY YOUR AGREEMENT(S) WITH SUCH THIRD-PARTY SERVICE PROVIDERS.4. PRIVACYPlease refer to our Privacy Policy for information about how we collect, use and disclose information about you when you Use Photiq. Transfer and storage of information about you, whilst you Use Photiq, is governed by our Privacy Policy. You acknowledge and agree that your Use of Photiq is subject to our Privacy Policy.5. USER CONTENTPhotiq may allow you to upload, edit, create, store and share photos (“User Content”). Except for the Company License you grant us below, you retain all rights in and to your User Content, as between you and us.You grant us a perpetual, revocable, nonexclusive, royalty-free, worldwide, fully-paid, transferable, sub-licensable license to use, reproduce, modify, adapt, translate, create derivative works from and transfer your User Content, without any additional compensation to you and always subject to your additional explicit consent for such use where required by applicable law and as stated in our Privacy Policy (the “Company License”). The Company License is for the limited purpose of operating, developing, providing and improving Photiq and researching, developing and improving our existing and new products, including but not limited to Photiq, unless you have provided us your additional explicit consent for the different purpose where required by applicable law.You grant us consent to use the User Content, regardless of whether it includes an individual’s name, likeness or persona, sufficient to indicate the individual’s identity. You further acknowledge and agree that our use of your User Content will not result in any injury to you or to any person you authorized to act on your behalf.You represent and warrant that: (i) you own the User Content stylized by you on or through Photiq or otherwise have the right to grant the rights and licenses set forth in these Terms; (ii) you agree to pay for all royalties, fees, and any other monies owed by reason of the User Content you stylize on or through Photiq; and (iii) you have the legal right and capacity to enter into these Terms in your jurisdiction.You may not upload, edit, create, store or share any User Content that violates these Terms or to which you do not have all the rights necessary to grant us the Company License described above.We will not be liable to you for any modification, suspension or discontinuation of Photiq, or the loss of any User Content.6. PROHIBITED CONDUCT AND CONTENTYou will not violate any applicable contract, intellectual property law, any other applicable law or other third-party rights (including the Company rights) or commit a tort, and you are solely responsible for your conduct while Using Photiq. You represent, warrant and agree that you will not Use Photiq by uploading the User Content or otherwise (all of the following conduct includes any attempts to perform any of the following):';
  String get TermsOfUse => _TermsOfUse;
  set TermsOfUse(String _value) {
    _TermsOfUse = _value;
    prefs.setString('ff_TermsOfUse', _value);
  }

  String _PrivacyPolicy =
      'Welcome to LEP trading S.R.O. (“Company,” “we,” “us” or “our”), a mobile technology company specializing in deep learning-related products. Our goal is to move forward mobile photography and video creation to the next level using neural networks, deep learning and computer vision technics. We aim to create new ways for people to express their emotions through the camera.This Privacy Policy (this “Privacy Policy”) describes:\nThe types of information we may collect or that all users or others may provide while downloading, installing, registering with, accessing, or otherwise using (“Users”, “you” or “your”, as applicable) our mobile application Photiq Photo Editor (“Photiq” or “application”).\nOur practices for collecting, using, maintaining, protecting, and disclosing that information.\nThis Privacy Policy applies only to information we collect in Photiq and via email, text, and other electronic communications sent through or in connection with Photiq.We undertake to build Photiq and any of its features in such a way that it respects your privacy and are committed to protecting it through our compliance with this Privacy Policy. This Privacy Policy not only allows you to understand what we do with your Personal Data (as defined below), but also to manage your Personal Data effectively.Please read this Privacy Policy carefully to understand our policies and practices regarding your information and how we will treat it. By downloading, installing, registering with, accessing or using (“Using”) Photiq, you agree to this Privacy Policy. If you do not agree to this Privacy Policy, do not Use Photiq.By Using Photiq you understand and agree that we are providing a platform for you to stylize photos. If you have any questions about this Privacy Policy or Photiq, please contact us (for contact information, please, see How to Contact Us Section).This Privacy Policy DOES NOT apply to the information that:\nWe collect offline or on any other our apps or websites, including websites you may access through Photiq.\nYou provide to or is collected by any third party, including through any other application or content that may link to or be accessible through Photiq.\nOur websites and other apps, and these other third parties may have their own privacy policies, which we encourage you to read before providing information on or through them.This Privacy Policy may change from time to time (see Changes to Our Privacy Policy Section). Your continued use of Photiq after we make changes is deemed to be acceptance of those changes, so please check this Privacy Policy periodically for updates.1. INFORMATION WE COLLECT AND HOW WE COLLECT ITWe may collect several types of information, including but not limited to Personal Data, from and about you:\nDirectly from you when you provide it to us.\nAutomatically when you Use Photiq. Information collected automatically may include Usage details, internet protocol (“IP”) addresses and information collected through cookies and other tracking technologies.\nFrom third parties, for example, our Service Providers (as defined below).\nTo the extent information is: (i) associated with an identified or identifiable natural person and (ii) protected as personal data under applicable data protection laws, such information is referred to in this Privacy Policy as “Personal Data”. Please bear in mind that provisions of Section 5 do not apply to your pseudonymized Personal Data.2. INFORMATION YOU PROVIDE TO US DIRECTLYWhen you Use Photiq, we may ask you to provide certain information, including your Personal Data:\nPhotos that you provide when you Use Photiq, via your camera or camera roll (if you have granted us permission to access your camera or camera roll). You may revoke permission to access your camera or camera roll through the settings on your mobile device. Please note that while we do not require or request any metadata attached to the photos you upload, metadata (including, for example, geotags) may be associated with your photos by default.\nInformation that you provide by interacting with Photiq. This includes information provided at the time of Using Photiq, purchasing certain enhanced features of Photiq, requesting further services through Photiq and filling in forms in Photiq. We may also ask you for information when you report a problem with Photiq.\nDetails of your in-app subscriptions in Photiq.\nIf you contact us, records, copies of your correspondence with us and contact details that you have provided us while making your inquiries (such as your name, postal addresses, email addresses and phone numbers or any other identifier by which you may be contacted online or offline), in order to investigate your concerns, respond to your inquiries and to monitor and improve our responses to your and other Users inquiries in relation to Photiq.\nYou may provide photos (with or without applied Photiq stylized filters or effects) for publication or display on third-party websites and other online services you access through Photiq (“Post”). You confirm that you have all required rights, approvals and consents from any third parties, if applicable, to use their photos or photos on which other individuals are shown through Photiq and to Post such photos on third-party websites and other online services. This may be applicable if you: (i) Post, or use photos (via Photiq) that are not your’s; or (ii) Post, or use photos (via Photiq) that show other individuals, that require such persons’ and/or individuals’ consent.Your photos are Posted and transmitted to others at your own risk. Please be aware that no security measures are perfect or impenetrable. Additionally, we cannot control the actions of third parties with whom you may choose to share your photos. Therefore, we cannot and do not guarantee that your photos will not be viewed by unauthorized persons.3. INFORMATION WE COLLECT THROUGH AUTOMATIC DATA COLLECTION TECHNOLOGIESWhen you Use Photiq, we may use automatic data collection technologies to collect certain information about your equipment, browsing actions and patterns, including:\nUsage details. Details of your Use of Photiq, including traffic data, logs and other communication data and resources you use through Photiq.\nDevice information. Information about your mobile device and internet connection, including your IP address, the device’s unique device identifier, operating system, browser type and mobile network information.\nStored information and files. Please note that while we do not require or request any metadata attached to the photos you upload to Photiq, metadata (including, for example, geotags) may be associated with your photos by default.\nWe also may use these technologies to collect information about your online activities over time and across third-party websites or other online services (behavioral tracking). If you do not want us to collect this information, do not download Photiq or delete it from your device.The information we collect automatically under this Privacy Policy may include your Personal Data and information we may maintain or associate with your Personal Data that we collect in other ways or receive from third parties. It helps us to improve Photiq and to deliver a better and more personalized service, including but not limited to enabling us to estimate our audience size and Usage patterns and recognize when you Use Photiq.If the information covered by this Section 3 is aggregated or de-identified so it is no longer reasonably associated with an identified or identifiable natural person, we may use it for any business purpose.The technologies we use for automatic data collection may include:Third-party analytics. We use third-party analytics tools, such as Google Firebase, Facebook Analytics, AppsFlyer and Amplitude, to help us measure traffic and usage trends for Photiq. These tools collect information sent by your device or Photiq, including the web pages you visit when following the links available to you on Photiq. We collect and use this analytics information with analytics information from other Users so that it cannot reasonably be used to identify any particular individual User. For information on how third-party analytics tools collect and process your data and to opt out of such collection and processing, generated by your Use of Photiq, please visit the following link.Cookies (or mobile cookies) and similar technologies. A cookie is a small file placed on your smartphone. When you Use Photiq, we may use cookies and similar technologies to collect information about how you Use Photiq and provide features to you. We may ask our Service Providers to serve services to your devices, which may include cookies or similar technologies placed by us or such Service Providers (on our request). You may refuse to accept mobile cookies by activating the appropriate mobile browser setting on your smartphone. You may also block, delete or disable saving cookies on your device. You can turn the cookies off by choosing the appropriate settings of your browser. The following links might be useful for you to choose the best option of your browser:For the users of Chrome on Android and iOS.For the users of Safari on iOS.However, if you select these mobile browser settings you may be unable to access certain parts of Photiq. Unless you have adjusted your mobile browser setting, our system will issue cookies when you direct your browser to Photiq.Log file information. Log file information is automatically reported by your mobile browser each time you make a request to Use Photiq. When you Use Photiq, we and our Service Providers may automatically record certain log file information, including your web request, IP address, browser type, referring/exit pages and URLs, number of clicks and how you interact with links on and through Photiq, domain names, landing pages, pages viewed, and other such information. The information allows us to receive more accurate reporting and improve Photiq.Device identifiers. When you use a mobile device like a tablet or phone to Use Photiq, we may access, collect, monitor, store on your device, and/or remotely store one or more “device identifiers”. Device identifiers are small data files or similar data structures stored on or associated with your mobile device, which uniquely identify your mobile device. A device identifier may identify data stored in connection with the device hardware, operating system or other software, or data sent to the device by us. A device identifier may deliver information to us or to our Service Providers about how you Use Photiq and may help us and others (on our request) produce a report on such Use.Some features of Photiq may not function properly if use or availability of device identifiers is impaired or disabled. Among others we collect the following device identifiers:\nUser device ID.\nPlatform (iOS/Android).\nDevice OS version.\nApp version.\nFirst request time.\nLanguage.\nModel.\nPush token (optional).\nMetadata. Metadata is a technical data that is associated with your photos. For example, metadata may describe when and on which device your photo has been taken and how such photo is formatted. You may add or may have metadata added to your photos. Please note that metadata associated with your photos is deleted automatically with your photos within 24 hours after we apply styles to them.Registered Users. If you are a registered User, we may collect more Personal Data about you including the following:\nEmail.\nUser device ID (generated by our application).\nFirst User authorization date and time.\nGoogle Play store account Information (UserID, nickname, profile image), if you choose to log in via your Google Play account.\nApple App store account information (Apple ID, profile image), if you choose to log in via Sign in with Apple.\n4. HOW WE USE COLLECTED INFORMATIONYour photos. We do not use photos you provide when you Use Photiq for any reason other than to apply different stylized filters or effects to them, unless you have given us your explicit consent to use the photos for a different purpose.Please note that to apply different stylized filters or effects to your photos we may upload such photos to the cloud providers we use (Google Cloud Platform and Amazon Web Services), in which case, the photos: (i) become available to us anonymously and (ii) are automatically deleted within 24 hours after being processed by Photiq, unless you have given us your explicit consent to use the photos for a different purpose.Other information. We may use your information other than photos for the following purposes:\nTo provide personalized content and information to you and others in relation to Photiq, which could include online ads or other forms of marketing (including via email).\nTo present to you and others with Photiq, its contents and any other information, products or services that you request from us.\nTo automatically update Photiq on your device.\nTo carry out our obligations and enforce our rights arising from any contracts entered into between you and us in relation to Photiq.\nTo provide you with support and to respond to your inquiries. If you share your Personal Data (including your name and contact information) to ask a question about Photiq, we will use that Personal Data to investigate your concerns, respond to your inquiries and to monitor and improve our responses to your and other Users inquiries in relation to Photiq.\nTo notify you about changes to Photiq or any products or services we offer or provide through Photiq, including by sending you technical notices, notices about your account/subscription, including expiration and renewal notices, updates, security alerts and support and administrative messages, which we may send through an in-app or a push notification (you may opt out of push notifications by changing the settings on your mobile device).\nTo diagnose or fix technology problems in relation to Photiq.\nTo link or combine with information we get from others or (and) from you to help understand your needs and provide you with better services.\nTo monitor metrics such as total number of Users, traffic, and demographic patterns (including via Service Providers as specified in Section 6).\nTo provide, improve, test, and monitor the effectiveness of Photiq.\nTo develop and test new products and features.\nTo fulfill any other purpose for which you provide it.\nIn any other way, we may describe in this Privacy Policy.\nFor any other purpose with your explicit consent.\nWe will not process your Personal Data in a way that is incompatible with the purposes for which it has been collected or authorized by you in accordance with this Section 4 or collect any Personal Data that is not required for the mentioned purposes (“purpose limitation principle”).For any new purpose of processing, we will ask for your separate explicit consent. To the extent necessary for those purposes, we take all reasonable steps to ensure that your Personal Data is reliable for its intended use, accurate, complete and current. We also undertake to collect only such amount and types of your Personal Data that are strictly required for the purposes mentioned in this Section 4 (“data minimization principle”).5. YOUR RIGHTSAccess, modification, correction and erasure. You can send us an email at support@photiq.io to request access to, modification, correction, update, erasure or deletion of any Personal Data that you have provided to us and that we have about you. We may not accommodate a request to change information if we believe the change would violate any law or legal requirement or cause the information to be incorrect.EEA/UK residents. Individuals residing in the European Economic Area (“EEA”) and the United Kingdom (“UK”) have certain statutory rights in relation to their Personal Data including under the General Data Protection Regulation (Regulation (EU) 2016/679) (“EEA GDPR”) and the Data Protection, Privacy and Electronic Communications (Amendments etc) (EU Exit) Regulations 2020 (SI 2020/1586), as may be amended from time to time (“UK GDPR”) (collectively, the “GDPR”), including the rights specified below. You can exercise these rights by contacting us (for contact information, please, see How to Contact Us Section).\nAccess to your Personal Data and data portability. You have a right to request information about whether we have any Personal Data about you, to access your Personal Data (including in a structured and portable form) that you have provided to us, when Using Photiq and that we have about you. You can do this by contacting us.\nRectification of your Personal Data and restriction of processing. You are responsible for ensuring the accuracy of your Personal Data that you provide to us. Inaccurate information may affect your experience when Using Photiq features and our ability to contact you as described in this Privacy Policy. If you believe that your Personal Data is inaccurate, you have a right to contact us and ask us to correct such Personal Data. You also have the right to demand restriction of processing of your Personal Data, if you contest the accuracy of the Personal Data which inaccuracy is verified by us.\nErasure of your Personal Data. If you believe that your Personal Data is no longer necessary in relation to the purposes for which it was collected or otherwise processed, or in cases where you have withdrawn your consent or object to the processing of your Personal Data, or where the processing of your Personal Data does not otherwise comply with the GDPR, you have the right to contact us and ask us to erase such Personal Data or by using a special feature in Photiq settings. Please be aware that erasing some Personal Data may affect your ability to Use Photiq.\nRight to object processing or otherwise using your Personal Data. You can object to and stop us from processing or otherwise using your Personal Data by contacting us. Please be aware that our inability to process or otherwise use some of your Personal Data may affect your ability to Use Photiq.\nNotification requirements. We commit to notify you promptly and your data protection authority within the timeframe specified in applicable law (72 hours) about any Personal Data breaches in relation to you.\nNotice about automated decision-making. We use automated decision-making tools (e.g. neural networks) that process your photos in order to provide you better services through Photiq.\nData Protection Authorities. Subject to the GDPR, you have the right to lodge a complaint with your local data protection authority about any of our activities that you deem are not compliant with the GDPR.\nPlease keep in mind that in case of a vague access, erasure, objection request or any other request in exercise of the mentioned rights we may engage you in a dialogue to better understand the motivation for the request and to locate responsive information. In case this is impossible, we reserve the right to refuse granting your request.Following the provisions of the GDPR, we might also ask you to prove your identity (for example, by requesting an ID or other proof) in order for you to invoke the mentioned rights. This is made to ensure that no right of third parties are violated by your request, and the mentioned rights are exercised by an actual Personal Data subject or an authorized person.Please note that we will grant your request within 30 days after receiving it, but it may take up to 90 days in some cases, for example for full erasure of your Personal Data stored in our backup systems - this is due to the size and complexity of the systems we use to store data.Opting Out of Promotional EmailsIF REQUIRED BY LAW, WE WILL ASK FOR YOUR CONSENT TO SEND YOU PROMOTIONAL AND MARKETING EMAILS. IF YOU WISH TO OPT OUT OF OUR PROMOTIONAL AND MARKETING EMAILS, YOU CAN OPT OUT FROM OUR PROMOTIONAL AND MARKETING EMAIL LIST BY USING ANY OF THE FOLLOWING METHODS:\nby following the opt-out links in any marketing email sent to you; or\nthrough Photiq settings on your mobile device; or\nby contacting us at any time using the contact details in How to Contact Us Section.\nBases for Using Your Personal Data. If you reside in the EEA or the UK we are only allowed to use your Personal Data when certain conditions apply. These conditions are called “legal bases” and we typically rely on one of four:\nContract. One reason we might use your Personal Data is because you formed a contract with us by accepting the Photiq terms of use, and use of your Personal Data is necessary for the performance of the contract. For example, to enable you to access and use Photiq or send you information that you have requested.\nLegitimate interest. Another reason we might use your information is because we have a legitimate interest in doing so. For example, we need to use your Personal Data to operate, protect, improve and optimize Photiq and your User experience, such as to perform analytics and conduct research.\nConsent. In some cases we will ask for consent to use your Personal Data for specific purposes. If we do, we will make sure you can revoke your consent in Photiq settings or by contacting us.\nLegal obligation. We may be required to use your Personal Data to comply with the law, for example, when we need to take action to protect our Users.\nYour California Privacy Rights. If you are a California resident, California law may provide you with additional rights regarding our use of your Personal Data. To learn more about your California privacy rights, visit (i) the following link and (ii) our CCPA Privacy Notice for California Residents.6. SHARING OF COLLECTED INFORMATIONWe may disclose aggregated information about our Users and information that does not identify any individual without any restriction. We may remove parts of data that can identify you and share anonymized data with any persons.We do not rent or sell your Personal Data, including photos, to any third parties outside the Company or its Affiliates (as defined below).Parties with whom we may share your Personal Data. We do not share or transfer your photos to third parties (with the exception of uploading the photos to our cloud providers Google Cloud Platform and Amazon Web Services to provide online processing function and storing and deleting such photos as described in this Privacy Policy).We use only secure places of storage, such as Google Cloud Platform and Amazon Web Services. Google LLC and Amazon Web Services, Inc. are located in the United States of America. To learn about data protection practices of Google LLC please visit the following link. To learn about data protection practices of Amazon Web Services, Inc. please visit the following link. We may share your Personal Data as well as other collected information (including but not limited to information from cookies, log files, device identifiers and Usage data) with businesses that are legally part of the same group of companies that we are part of, including our subsidiaries, or that become part of that group (“Affiliates”). Affiliates may use this information to help provide, understand, and improve Photiq (including by providing analytics). Such Affiliates are bound by the rules of this Privacy Policy.We also may share your Personal Data and other collected information with third-party organizations such as contractors and service providers that we use to support our business and who are bound by confidentiality and data protection terms (consistent with this Privacy Policy) to keep your Personal Data confidential and use it only for the purposes for which we disclose it to them (and as directed and authorised by us) (“Service Providers”).Such Service Providers include (i) cloud providers Google Cloud Platform and Amazon Web Services, that we use to apply photo editing features of Photiq to your photos and to store and delete such photos, as described in this Privacy Policy, (ii) third parties that may use your photos collected by us in the ways described in this Privacy Policy and where legally required with your explicit consent, (iii) third-party analytics, as specified in this Privacy Policy, (iv) email delivery services and (v) professional advisors, such as lawyers, auditors and insurers, in the course of the professional services that they render to us.Meta API Conversions. We also utilize Meta API service called “API Conversions” which creates a connection between our marketing data and Meta systems. Meta API Conversions, among other things, help us in optimizing ad targeting. According to these purposes, we send your hashed email addresses to Meta API Conversions service.What happens in the event of a change of control. If we sell or otherwise transfer part or the whole of the Company or our assets to another organization (e.g., in the course of a transaction like a merger, divestiture, restructuring, reorganization, acquisition, bankruptcy, dissolution, liquidation), your Personal Data and any other collected information may be among the items sold or transferred. The buyer or transferee will have to honor the commitments we have made in this Privacy Policy.Responding to legal requests and preventing harm. We may access, preserve and share your information in response to a legal (like a search warrant, court order or subpoena), government or regulatory request if we have a good faith belief that the law requires us to do so. This may include responding to legal, government or regulatory requests from jurisdictions outside of the United States where we have a good faith belief that the response is required by law in that jurisdiction, affects Users in that jurisdiction, and is consistent with internationally recognized standards. We may also access, preserve and share information when we have a good faith belief it is necessary to: (i) detect, prevent and address fraud and other illegal activity; (ii) protect ourselves, you and others, including as part of investigations; and (iii) prevent death or imminent bodily harm. Information we receive about you may be accessed, processed and retained for an extended period of time when it is the subject of a legal request or obligation, governmental investigation, or investigations concerning possible violations of our terms or policies, or otherwise to prevent harm.7. DATA SECURITYWe use reasonable and appropriate information security safeguards to help keep the collected information secure and to secure it from accidental loss and unauthorized access, use, alteration and disclosure. Unfortunately, the transmission of information via the internet is not completely secure. Although we do our best to protect your collected information, we cannot guarantee the security of the collected information transmitted to or through Photiq or an absolute guarantee that such information may not be accessed, disclosed, altered, or destroyed. Any transmission of your collected information is at your own risk. We are not responsible for circumvention of security measures contained in Photiq. Please understand that there is no ideal technology or measure to maintain 100% security. Among others, we utilize the following information security measures:\nPseudominization of certain categories of your Personal Data.\nEncryption of your Personal Data in transit and in rest.\nAll collected information is stored on our secure servers behind firewalls.\nOrganizational and legal measures. For example, our employees and employees of our subsidiaries have different levels of access to your Personal Data and only those in charge of data management get access to your Personal Data and only for limited purposes required for the operation of Photiq. We impose strict liability on such employees for any disclosures, unauthorized accesses, alterations, destructions and misuses of your Personal Data.\nConducting periodical data protection impact assessments in order to ensure that the Company fully adheres to the principles of “privacy by design”, “privacy by default” and others. We also commit to undertake privacy audit in case of the Company’s merger or takeover.\nThe safety and security of your information also depends on you. Your privacy settings may also be affected by changes the social media services, through which you may share your photos, make to their services. We are not responsible for the functionality, privacy or security measures of any other organization.Contacting us. You can provide your feedback or report a technical issue by using “Send Feedback” button in Photiq settings. The email will be sent from your personal email to support@photiq.io, and the message will contain the following diagnostics information that will help us to resolve your issue/address your request:\nPhone model.\nDevice OS version.\nPlatform (iOS/Android).\nApp version.\nUser device ID.\nLanguage.\nRemaining space.\nThis information is used to assess your feedback and/or identify the problem if you are reporting one and is NOT USED to identify Users individually.Contacting you. By Using Photiq you consent to receive electronic communications from us (e.g., by posting in-app notices in Photiq, push notifications or emails). These communications may include notices about Photiq (e.g., changes/updates to features of Photiq and their scope, prices of in-app subscriptions, technical and security notices, updates to this Privacy Policy and Photiq terms of use), Photiq in-app subscriptions and marketing and promotional materials.8. DATA RETENTIONWe retain your Personal Data for as long as we need it for the purposes for which it was obtained or until you ask us to delete it. We also may retain your Personal Data for a longer period of time on the basis of our legitimate interests, for example, as necessary to comply with our tax and legal obligations, to resolve disputes, and to enforce our agreements. Even if we delete some or all of your Personal Data, we may continue to retain and use aggregated or anonymous data previously collected that can no longer be used for personal identification.9. CROSS-BORDER TRANSFERSThe Company is based in the United States. Accordingly, your Personal Data may be transferred to and stored on servers in the United States. Your Personal Data may be transferred to any country where Google Cloud Platform and Amazon Web Services have/use servers. As the Company has a development and marketing team based in Czech Republic, your Personal Data also may be transferred to and stored on servers in Cyprus or Czech Republic.The data protection and privacy laws of the United States, Cyprus and other counties may not be as comprehensive or offer the same protections as the laws in your country. For example, personal data transferred to the United States and Cyprus may be subject to lawful access requests by legal authorities. You nevertheless consent to the transfer of your Personal Data to the United States, Cyprus and other countries where the Company is located, or is providing products or services, or from where its Affiliates and Service Providers provide their products and services to the Company and its Affiliates.In appropriate cases, the Company will enter into standard contractual clauses as approved under the European Commission Decision C(2010)593 or decision 2004/915/EC, as applicable, to permit the transfer of your Personal Data to the United States, Cyprus or another country that has not been deemed to provide adequate level of data protection.10. CHILDREN’S PRIVACYGeneral age limitation. Photiq is not intended for or directed at children under 13, and we do not knowingly collect or solicit any information from anyone under the age of 13 or knowingly allow such persons to Use Photiq. If you are under 13, do not: (i) Use or provide any information in Photiq or through any of its features, or (ii) provide any information about yourself to us, including your name, address, telephone number or email address. In the event that we learn that we have collected or received any Personal Data from a child under 13 without verification of parental consent, we will delete that information as quickly as possible. If you believe we might have any information from or about a child under 13, please contact us (for contact information, please, see How to Contact Us Section).Age limitation for EEA residents. Due to requirements of the EEA GDPR you shall be at least 16 years old in order to Use Photiq. To the extent prohibited by applicable law, we do not allow Use of Photiq by the EEA residents younger than 16 years old. If you are aware of anyone younger than 16 Using Photiq, please contact us (for contact information, please, see How to Contact Us Section) and we will take required steps to delete information provided by such persons.11. OTHER WEBSITES AND SERVICESWe are not responsible for the practices employed by any websites or services linked to or from Photiq, including the information or content contained within them. Where we have a link to a website or service, linked to or from Photiq, we encourage you to read the privacy policy stated on that website or service before providing information on or through it.12. HOW TO CONTACT US. EEA/UK REPRESENTATIVE AND DATA PROTECTION OFFICERGeneral contact details. If you have any questions about this Privacy Policy or Photiq, please contact us via email at privacy@photiq.io or our mailing address:LEP trading S.R.O.Czech Republic, Prague,Vinohrady, Londynska 730/591200013. CHANGES TO OUR PRIVACY POLICYThe Company may modify or update this Privacy Policy from time to time, so please review it periodically. The date this Privacy Policy was last revised is identified at the top of the page. Your continued Use of Photiq after we make changes to this Privacy Policy is deemed to be acceptance by you of those changes, so please check the policy periodically for updates. In some cases, we may require you to expressly accept our new privacy policy in order to continue Using Photiq (for example, if we expand types of Personal Data collected from you or introduce new purposes of collection and processing).';
  String get PrivacyPolicy => _PrivacyPolicy;
  set PrivacyPolicy(String _value) {
    _PrivacyPolicy = _value;
    prefs.setString('ff_PrivacyPolicy', _value);
  }

  final _mainPageManager = StreamRequestManager<List<AiImageRecord>>();
  Stream<List<AiImageRecord>> mainPage({
    String? uniqueQueryKey,
    bool? overrideCache,
    required Stream<List<AiImageRecord>> Function() requestFn,
  }) =>
      _mainPageManager.performRequest(
        uniqueQueryKey: uniqueQueryKey,
        overrideCache: overrideCache,
        requestFn: requestFn,
      );
  void clearMainPageCache() => _mainPageManager.clear();
  void clearMainPageCacheKey(String? uniqueKey) =>
      _mainPageManager.clearRequest(uniqueKey);

  final _stylesManager = StreamRequestManager<List<StylesRecord>>();
  Stream<List<StylesRecord>> styles({
    String? uniqueQueryKey,
    bool? overrideCache,
    required Stream<List<StylesRecord>> Function() requestFn,
  }) =>
      _stylesManager.performRequest(
        uniqueQueryKey: uniqueQueryKey,
        overrideCache: overrideCache,
        requestFn: requestFn,
      );
  void clearStylesCache() => _stylesManager.clear();
  void clearStylesCacheKey(String? uniqueKey) =>
      _stylesManager.clearRequest(uniqueKey);
}

LatLng? _latLngFromString(String? val) {
  if (val == null) {
    return null;
  }
  final split = val.split(',');
  final lat = double.parse(split.first);
  final lng = double.parse(split.last);
  return LatLng(lat, lng);
}

void _safeInit(Function() initializeField) {
  try {
    initializeField();
  } catch (_) {}
}

Future _safeInitAsync(Function() initializeField) async {
  try {
    await initializeField();
  } catch (_) {}
}
